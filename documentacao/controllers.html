<!DOCTYPE html>
<html lang="pt-PT">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Documentação de Controllers - ESA Terra Argila</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background-color: #f5f5f5;
            border-radius: 5px;
        }
        nav {
            background-color: #f8f8f8;
            padding: 10px;
            margin-bottom: 20px;
            border-radius: 5px;
        }
        nav ul {
            list-style-type: none;
            padding: 0;
            display: flex;
            justify-content: center;
        }
        nav ul li {
            margin: 0 10px;
        }
        nav ul li a {
            text-decoration: none;
            color: #0066cc;
            font-weight: bold;
        }
        section {
            margin-bottom: 40px;
            border: 1px solid #ddd;
            padding: 20px;
            border-radius: 5px;
        }
        h1, h2, h3 {
            color: #2c3e50;
        }
        h2 {
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        .action {
            margin-bottom: 20px;
            padding-left: 15px;
            border-left: 3px solid #3498db;
        }
        .action h4 {
            margin-bottom: 5px;
            color: #2980b9;
        }
        .action p {
            margin-top: 5px;
        }
        .http-method {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.8em;
            margin-right: 8px;
            font-weight: bold;
            color: white;
        }
        .get {
            background-color: #61affe;
        }
        .post {
            background-color: #49cc90;
        }
        .put {
            background-color: #fca130;
        }
        .delete {
            background-color: #f93e3e;
        }
        .param {
            margin-left: 20px;
            font-family: monospace;
            color: #16a085;
        }
        .attributes {
            margin-top: 5px;
            color: #7f8c8d;
            font-style: italic;
        }
        .index {
            background-color: #f8f8f8;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 30px;
        }
        .index ul {
            list-style-type: none;
            padding: 0;
            column-count: 2;
        }
        .index ul li {
            margin-bottom: 8px;
        }
        .index ul li a {
            text-decoration: none;
            color: #0066cc;
        }
        .back-to-top {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #3498db;
            color: white;
            width: 40px;
            height: 40px;
            text-align: center;
            line-height: 40px;
            border-radius: 50%;
            text-decoration: none;
            opacity: 0.7;
        }
        .back-to-top:hover {
            opacity: 1;
        }
        @media (max-width: 768px) {
            .index ul {
                column-count: 1;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>Documentação de Controllers - ESA Terra Argila</h1>
        <p>Documentação gerada a partir dos comentários XML do código fonte</p>
    </header>
    
    <nav>
        <ul>
            <li><a href="../documentacao/index.html">Início</a></li>
            <li><a href="../documentacao/models.html">Models</a></li>
            <li><a href="../documentacao/api-models.html">API Models</a></li>
            <li><a href="../documentacao/orders.html">Sistema de Pedidos</a></li>
        </ul>
    </nav>
    
    <div class="index">
        <h2>Índice de Controllers</h2>
        <ul>
            <li><a href="#categories-controller">CategoriesController</a></li>
            <li><a href="#products-controller">ProductsController</a></li>
            <li><a href="#orders-controller">OrdersController</a></li>
            <li><a href="#admin-controller">AdminController</a></li>
            <li><a href="#admin-invite-controller">AdminInviteController</a></li>
            <li><a href="#dashboard-controller">DashboardController</a></li>
            <li><a href="#home-controller">HomeController</a></li>
            <li><a href="#tags-controller">TagsController</a></li>
        </ul>
    </div>
    
    <section id="categories-controller">
        <h2>CategoriesController</h2>
        <p>Controller responsável pelo gerenciamento de categorias. Todas as ações requerem autenticação, exceto quando explicitamente permitido.</p>
        
        <h3>Ações</h3>
        
        <div class="action">
            <h4><span class="http-method get">GET</span>Index()</h4>
            <p>Exibe a lista de categorias do usuário atual.</p>
            <p><strong>Retorno:</strong> View com a lista de categorias</p>
        </div>
        
        <div class="action">
            <h4><span class="http-method get">GET</span>Details(int? id)</h4>
            <p>Exibe os detalhes de uma categoria específica. Ação acessível por qualquer usuário, mesmo não autenticado.</p>
            <p><strong>Parâmetros:</strong></p>
            <p class="param">id - ID da categoria</p>
            <p><strong>Retorno:</strong> View com os detalhes da categoria ou NotFound se não existir</p>
            <p class="attributes">[AllowAnonymous]</p>
        </div>
        
        <div class="action">
            <h4><span class="http-method get">GET</span>Create()</h4>
            <p>Exibe o formulário para criação de uma nova categoria.</p>
            <p><strong>Retorno:</strong> View com o formulário de criação</p>
        </div>
        
        <div class="action">
            <h4><span class="http-method post">POST</span>Create(Category category)</h4>
            <p>Processa o envio do formulário de criação de uma nova categoria.</p>
            <p><strong>Parâmetros:</strong></p>
            <p class="param">category - Dados da categoria a ser criada</p>
            <p><strong>Retorno:</strong> Redireciona para Index em caso de sucesso ou retorna à View com os dados em caso de erro</p>
            <p class="attributes">[HttpPost], [ValidateAntiForgeryToken]</p>
        </div>
        
        <div class="action">
            <h4><span class="http-method get">GET</span>Edit(int? id)</h4>
            <p>Exibe o formulário para edição de uma categoria existente.</p>
            <p><strong>Parâmetros:</strong></p>
            <p class="param">id - ID da categoria a ser editada</p>
            <p><strong>Retorno:</strong> View com o formulário de edição ou NotFound se a categoria não existir</p>
        </div>
        
        <div class="action">
            <h4><span class="http-method post">POST</span>Edit(int id, Category category)</h4>
            <p>Processa o envio do formulário de edição de uma categoria.</p>
            <p><strong>Parâmetros:</strong></p>
            <p class="param">id - ID da categoria</p>
            <p class="param">category - Dados atualizados da categoria</p>
            <p><strong>Retorno:</strong> Redireciona para Index em caso de sucesso ou retorna à View com os dados em caso de erro</p>
            <p class="attributes">[HttpPost], [ValidateAntiForgeryToken]</p>
        </div>
        
        <div class="action">
            <h4><span class="http-method get">GET</span>Delete(int? id)</h4>
            <p>Remove uma categoria específica. Esta ação remove diretamente a categoria sem confirmação.</p>
            <p><strong>Parâmetros:</strong></p>
            <p class="param">id - ID da categoria a ser removida</p>
            <p><strong>Retorno:</strong> Redireciona para Index após a remoção ou NotFound se a categoria não existir</p>
        </div>
        
        <div class="action">
            <h4><span class="http-method post">POST</span>DeleteConfirmed(int id)</h4>
            <p>Processa a confirmação de remoção de uma categoria. (Método não utilizado atualmente)</p>
            <p><strong>Parâmetros:</strong></p>
            <p class="param">id - ID da categoria a ser removida</p>
            <p><strong>Retorno:</strong> Redireciona para Index após a remoção</p>
            <p class="attributes">[HttpPost], [ValidateAntiForgeryToken], [ActionName("Delete")]</p>
        </div>
    </section>
    
    <section id="products-controller">
        <h2>ProductsController</h2>
        <p>Controller responsável pelo gerenciamento de produtos. Requer autenticação para a maioria das ações, exceto quando explicitamente permitido.</p>
        
        <h3>Ações</h3>
        
        <div class="action">
            <h4><span class="http-method get">GET</span>Index()</h4>
            <p>Exibe a lista de produtos do usuário atual.</p>
            <p><strong>Retorno:</strong> View com a lista de produtos</p>
        </div>
        
        <div class="action">
            <h4><span class="http-method get">GET</span>List(int? page, string? orderBy, float? priceMin, float? priceMax, List&lt;string&gt;? vendors, string? search)</h4>
            <p>Exibe a lista de produtos para todos os usuários, com opções de filtragem e paginação. Esta ação é acessível por qualquer usuário, mesmo não autenticado.</p>
            <p><strong>Parâmetros:</strong></p>
            <p class="param">page - Número da página atual</p>
            <p class="param">orderBy - Ordem de classificação (asc/desc)</p>
            <p class="param">priceMin - Preço mínimo para filtro</p>
            <p class="param">priceMax - Preço máximo para filtro</p>
            <p class="param">vendors - Lista de IDs de vendedores para filtro</p>
            <p class="param">search - Termo de busca</p>
            <p><strong>Retorno:</strong> View com a lista de produtos filtrada e paginada</p>
            <p class="attributes">[AllowAnonymous]</p>
        </div>
        
        <div class="action">
            <h4><span class="http-method get">GET</span>Details(int? id)</h4>
            <p>Exibe os detalhes de um produto específico.</p>
            <p><strong>Parâmetros:</strong></p>
            <p class="param">id - ID do produto</p>
            <p><strong>Retorno:</strong> View com os detalhes do produto ou NotFound se não existir</p>
        </div>
        
        <div class="action">
            <h4><span class="http-method get">GET</span>Create()</h4>
            <p>Exibe o formulário para criação de um novo produto.</p>
            <p><strong>Retorno:</strong> View com o formulário de criação</p>
        </div>
        
        <div class="action">
            <h4><span class="http-method post">POST</span>Create(Product product, List&lt;IFormFile&gt; Images, List&lt;int&gt; Tags, List&lt;int&gt; Materials, List&lt;float?&gt; MaterialsQty)</h4>
            <p>Processa o envio do formulário de criação de um novo produto.</p>
            <p><strong>Parâmetros:</strong></p>
            <p class="param">product - Dados do produto a ser criado</p>
            <p class="param">Images - Lista de imagens do produto</p>
            <p class="param">Tags - Lista de IDs de tags associadas ao produto</p>
            <p class="param">Materials - Lista de IDs de materiais utilizados no produto</p>
            <p class="param">MaterialsQty - Lista de quantidades dos materiais utilizados</p>
            <p><strong>Retorno:</strong> Redireciona para Index em caso de sucesso ou retorna à View com os dados em caso de erro</p>
            <p class="attributes">[HttpPost], [ValidateAntiForgeryToken]</p>
        </div>
        
        <div class="action">
            <h4><span class="http-method get">GET</span>Edit(int? id)</h4>
            <p>Exibe o formulário para edição de um produto existente.</p>
            <p><strong>Parâmetros:</strong></p>
            <p class="param">id - ID do produto a ser editado</p>
            <p><strong>Retorno:</strong> View com o formulário de edição ou NotFound se o produto não existir</p>
        </div>
    </section>
    
    <section id="orders-controller">
        <h2>OrdersController</h2>
        <p>Controller responsável pelo gerenciamento de pedidos e carrinho de compras.</p>
        
        <h3>Ações</h3>
        
        <div class="action">
            <h4><span class="http-method get">GET</span>Cart()</h4>
            <p>Exibe o carrinho de compras do usuário atual. Se não existir um carrinho, cria um novo.</p>
            <p><strong>Retorno:</strong> View com o carrinho de compras</p>
        </div>
        
        <div class="action">
            <h4><span class="http-method get">GET</span>AddToCart(int id)</h4>
            <p>Adiciona um item ao carrinho de compras. Se o carrinho não existir, cria um novo.</p>
            <p><strong>Parâmetros:</strong></p>
            <p class="param">id - ID do item a ser adicionado</p>
            <p><strong>Retorno:</strong> Redireciona para a página anterior ou para a página inicial</p>
        </div>
        
        <div class="action">
            <h4><span class="http-method get">GET</span>BuyNow(int id)</h4>
            <p>Inicia o processo de compra imediata para um item. (Método stub, não implementado completamente)</p>
            <p><strong>Parâmetros:</strong></p>
            <p class="param">id - ID do item a ser comprado</p>
            <p><strong>Retorno:</strong> Resultado OK (método a ser implementado)</p>
        </div>
        
        <div class="action">
            <h4><span class="http-method post">POST</span>AddQuantity(AddQuantityRequestModel request)</h4>
            <p>Altera a quantidade de um item no carrinho de compras.</p>
            <p><strong>Parâmetros:</strong></p>
            <p class="param">request - Modelo com ID do item e valor a ser adicionado à quantidade</p>
            <p><strong>Retorno:</strong> Resultado JSON com informações atualizadas</p>
            <p class="attributes">[HttpPost]</p>
        </div>
        
        <div class="action">
            <h4><span class="http-method get">GET</span>GetCartItemCount()</h4>
            <p>Retorna o número de itens no carrinho de compras do usuário atual.</p>
            <p><strong>Retorno:</strong> Resultado JSON com a contagem de itens</p>
        </div>
        
        <div class="action">
            <h4><span class="http-method get">GET</span>DeleteItem(int? id)</h4>
            <p>Remove um item do carrinho de compras.</p>
            <p><strong>Parâmetros:</strong></p>
            <p class="param">id - ID do item a ser removido</p>
            <p><strong>Retorno:</strong> Redireciona para a página anterior</p>
        </div>
    </section>
    
    <section id="admin-controller">
        <h2>AdminController</h2>
        <p>Controller responsável pelas ações administrativas do sistema. Requer autenticação e papel de administrador (Admin) para acesso a todas as ações.</p>
        
        <h3>Ações</h3>
        
        <div class="action">
            <h4><span class="http-method get">GET</span>AcceptUsers()</h4>
            <p>Exibe a lista de usuários pendentes de aprovação pelo administrador.</p>
            <p><strong>Retorno:</strong> View com a lista de usuários não aprovados</p>
        </div>
        
        <div class="action">
            <h4><span class="http-method get">GET</span>Vendors()</h4>
            <p>Exibe a lista de vendedores aprovados no sistema.</p>
            <p><strong>Retorno:</strong> View com a lista de vendedores</p>
        </div>
        
        <div class="action">
            <h4><span class="http-method get">GET</span>Suppliers()</h4>
            <p>Exibe a lista de fornecedores aprovados no sistema.</p>
            <p><strong>Retorno:</strong> View com a lista de fornecedores</p>
        </div>
        
        <div class="action">
            <h4><span class="http-method get">GET</span>Customers()</h4>
            <p>Exibe a lista de clientes aprovados no sistema.</p>
            <p><strong>Retorno:</strong> View com a lista de clientes</p>
        </div>
        
        <div class="action">
            <h4><span class="http-method post">POST</span>AcceptUser(string id)</h4>
            <p>Aprova um usuário pendente no sistema.</p>
            <p><strong>Parâmetros:</strong></p>
            <p class="param">id - ID do usuário a ser aprovado</p>
            <p><strong>Retorno:</strong> Redireciona para a lista de usuários pendentes</p>
            <p class="attributes">[HttpPost], [ValidateAntiForgeryToken]</p>
        </div>
        
        <div class="action">
            <h4><span class="http-method post">POST</span>Delete(string id)</h4>
            <p>Remove um usuário do sistema.</p>
            <p><strong>Parâmetros:</strong></p>
            <p class="param">id - ID do usuário a ser removido</p>
            <p><strong>Retorno:</strong> Redireciona para a lista de usuários pendentes</p>
            <p class="attributes">[HttpPost], [ValidateAntiForgeryToken]</p>
        </div>
        
        <div class="action">
            <h4><span class="http-method post">POST</span>BlockUser(string id)</h4>
            <p>Bloqueia um usuário aprovado no sistema.</p>
            <p><strong>Parâmetros:</strong></p>
            <p class="param">id - ID do usuário a ser bloqueado</p>
            <p><strong>Retorno:</strong> Redireciona para a página anterior ou para a lista de usuários pendentes</p>
            <p class="attributes">[HttpPost], [ValidateAntiForgeryToken]</p>
        </div>
        
        <div class="action">
            <h4><span class="http-method post">POST</span>InviteVendor(string id)</h4>
            <p>Envia um convite para um usuário se juntar como vendedor. Método não implementado completamente.</p>
            <p><strong>Parâmetros:</strong></p>
            <p class="param">id - ID do usuário a ser convidado</p>
            <p><strong>Retorno:</strong> Redireciona para a lista de usuários pendentes</p>
            <p class="attributes">[HttpPost], [ValidateAntiForgeryToken]</p>
        </div>
        
        <div class="action">
            <h4><span class="http-method post">POST</span>InviteSupplier(string id)</h4>
            <p>Envia um convite para um usuário se juntar como fornecedor. Método não implementado completamente.</p>
            <p><strong>Parâmetros:</strong></p>
            <p class="param">id - ID do usuário a ser convidado</p>
            <p><strong>Retorno:</strong> Redireciona para a lista de usuários pendentes</p>
            <p class="attributes">[HttpPost], [ValidateAntiForgeryToken]</p>
        </div>
    </section>
    
    <section id="admin-invite-controller">
        <h2>AdminInviteController</h2>
        <p>Controller responsável pelo gerenciamento de convites administrativos no sistema. Fornece funcionalidades para enviar convites e processar registros de novos usuários.</p>
        
        <h3>Ações</h3>
        
        <div class="action">
            <h4><span class="http-method post">POST</span>SendInvitation(InvitationRequest request)</h4>
            <p>Envia um convite por email para um novo usuário se registrar no sistema.</p>
            <p><strong>Parâmetros:</strong></p>
            <p class="param">request - Modelo contendo o email do usuário a ser convidado</p>
            <p><strong>Retorno:</strong> Ok se o convite for enviado com sucesso, ou BadRequest se houver erro</p>
            <p class="attributes">[HttpPost], [Route("api/[controller]")]</p>
        </div>

        <div class="action">
            <h4><span class="http-method get">GET</span>Register(string token, string email)</h4>
            <p>Processa o registro de um novo usuário através de um convite válido.</p>
            <p><strong>Parâmetros:</strong></p>
            <p class="param">token - Token de validação do convite</p>
            <p class="param">email - Email do usuário convidado</p>
            <p><strong>Retorno:</strong> Redirecionamento para a página de registro ou BadRequest se o convite for inválido</p>
        </div>

        <h3>Segurança</h3>
        <div class="attributes">
            <ul>
                <li>Tokens são gerados usando criptografia segura (RandomNumberGenerator)</li>
                <li>Convites expiram após 7 dias</li>
                <li>Convites só podem ser usados uma vez</li>
                <li>Tokens são codificados em Base64URL para segurança na URL</li>
            </ul>
        </div>
    </section>
    
    <section id="dashboard-controller">
        <h2>DashboardController</h2>
        <p>Controller responsável pelo painel de controle do sistema. Gerencia o redirecionamento dos usuários para suas respectivas áreas baseado em suas funções.</p>
        
        <h3>Ações</h3>
        
        <div class="action">
            <h4><span class="http-method get">GET</span>Item()</h4>
            <p>Redireciona o usuário para sua área específica baseado em sua função no sistema.</p>
            <p><strong>Retorno:</strong> Redirecionamento para a área apropriada baseado na função do usuário</p>
            <p class="attributes">[Authorize]</p>
            <div class="param">
                <strong>Redirecionamentos:</strong>
                <ul>
                    <li>Vendor → /Products/Index</li>
                    <li>Supplier → /Materials/Index</li>
                    <li>Admin → /Admin/AcceptUsers</li>
                    <li>Outros → /Home/Index</li>
                </ul>
            </div>
        </div>

        <div class="action">
            <h4><span class="http-method get">GET</span>Index()</h4>
            <p>Exibe a página principal do painel de controle.</p>
            <p><strong>Retorno:</strong> View padrão do dashboard</p>
            <p class="attributes">[Authorize]</p>
        </div>
    </section>
    
    <section id="home-controller">
        <h2>HomeController</h2>
        <p>Controller responsável pela página inicial e funcionalidades básicas do site. Gerencia a exibição da página inicial, política de privacidade e tratamento de erros.</p>
        
        <h3>Ações</h3>
        
        <div class="action">
            <h4><span class="http-method get">GET</span>Index()</h4>
            <p>Exibe a página inicial do site com os 4 produtos mais vendidos.</p>
            <p><strong>Retorno:</strong> View com os produtos mais populares</p>
            <div class="param">
                <strong>Funcionalidades:</strong>
                <ul>
                    <li>Busca os produtos mais vendidos no sistema</li>
                    <li>Inclui imagens e informações do vendedor</li>
                    <li>Limita a exibição aos 4 produtos mais populares</li>
                </ul>
            </div>
        </div>

        <div class="action">
            <h4><span class="http-method get">GET</span>Privacy()</h4>
            <p>Exibe a página de política de privacidade do site.</p>
            <p><strong>Retorno:</strong> View da política de privacidade</p>
        </div>

        <div class="action">
            <h4><span class="http-method get">GET</span>Error()</h4>
            <p>Exibe a página de erro quando ocorre uma exceção no sistema.</p>
            <p><strong>Retorno:</strong> View de erro com informações sobre a requisição que falhou</p>
            <p class="attributes">[ResponseCache(Duration = 0, Location = ResponseCacheLocation.None, NoStore = true)]</p>
        </div>
    </section>

    <section id="tags-controller">
        <h2>TagsController</h2>
        <p>Controller responsável pelo gerenciamento de tags no sistema. Permite a criação, edição, visualização e remoção de tags associadas a produtos e materiais.</p>
        
        <h3>Ações</h3>
        
        <div class="action">
            <h4><span class="http-method get">GET</span>Index()</h4>
            <p>Exibe a lista de tags do usuário atual.</p>
            <p><strong>Retorno:</strong> View com a lista de tags do usuário</p>
        </div>

        <div class="action">
            <h4><span class="http-method get">GET</span>Details(int? id)</h4>
            <p>Exibe os detalhes de uma tag específica.</p>
            <p><strong>Parâmetros:</strong></p>
            <p class="param">id - ID da tag a ser visualizada</p>
            <p><strong>Retorno:</strong> View com os detalhes da tag ou NotFound se não existir</p>
        </div>

        <div class="action">
            <h4><span class="http-method get">GET</span>Create()</h4>
            <p>Exibe o formulário para criação de uma nova tag.</p>
            <p><strong>Retorno:</strong> View com o formulário de criação</p>
        </div>

        <div class="action">
            <h4><span class="http-method post">POST</span>Create(Tag tag)</h4>
            <p>Processa o envio do formulário de criação de uma nova tag.</p>
            <p><strong>Parâmetros:</strong></p>
            <p class="param">tag - Dados da tag a ser criada</p>
            <p><strong>Retorno:</strong> Redirecionamento para Index em caso de sucesso ou View com erros em caso de falha</p>
            <p class="attributes">[HttpPost], [ValidateAntiForgeryToken]</p>
        </div>

        <div class="action">
            <h4><span class="http-method get">GET</span>Edit(int? id)</h4>
            <p>Exibe o formulário para edição de uma tag existente.</p>
            <p><strong>Parâmetros:</strong></p>
            <p class="param">id - ID da tag a ser editada</p>
            <p><strong>Retorno:</strong> View com o formulário de edição ou NotFound se a tag não existir</p>
        </div>

        <div class="action">
            <h4><span class="http-method post">POST</span>Edit(int id, Tag tag)</h4>
            <p>Processa o envio do formulário de edição de uma tag.</p>
            <p><strong>Parâmetros:</strong></p>
            <p class="param">id - ID da tag a ser editada</p>
            <p class="param">tag - Dados atualizados da tag</p>
            <p><strong>Retorno:</strong> Redirecionamento para Index em caso de sucesso ou View com erros em caso de falha</p>
            <p class="attributes">[HttpPost], [ValidateAntiForgeryToken]</p>
        </div>

        <div class="action">
            <h4><span class="http-method get">GET</span>Delete(int? id)</h4>
            <p>Remove uma tag específica do sistema.</p>
            <p><strong>Parâmetros:</strong></p>
            <p class="param">id - ID da tag a ser removida</p>
            <p><strong>Retorno:</strong> Redirecionamento para Index após a remoção ou NotFound se a tag não existir</p>
        </div>
    </section>
    
    <a href="#" class="back-to-top">↑</a>
</body>
</html> 